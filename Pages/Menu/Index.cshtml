@page
@model Carlos_Pizza.Pages.Menu.IndexModel

@{
    ViewData["Title"] = "Menu";
}

<div class="text-center">
    <h1 class="display-4">Menu</h1>
    <p>Please select an item, then add it to your cart.</p>
</div>

@* Search bar *@
<div class="flex-container">
    <form method="post" class="flex-container justify-content-center">
        <input asp-for="SearchString" class="searchbar" />
        <button type="submit" asp-page-handler="Search">Search</button>
    </form>
</div>
<hr/>

@* Same as Pages/index.cshtml, with a buy button *@
<div class="flex-container">
    @foreach (var m in Model.MenuItem
                  .Where(item => item.Available == true))
                  // .OrderBy(item => item.Category))
    {
        <div>
            <a asp-page="./Details" asp-route-id="@m.Id">
                @if (m.Image != null && m.Image.Length > 0)
                {
                    string base64String = Convert.ToBase64String(m.Image);
                    string imageSrc = $"data:image/webp;base64,{base64String}";
                    <img src="@imageSrc" alt="@Html.DisplayFor(modelItem => m.Name) image" />
                }
                <h3>@Html.DisplayFor(modelItem => m.Name)</h3>
                <p>@Html.DisplayFor(modelItem => m.Price)</p>
                @if (User.Identity is { IsAuthenticated: true }) {
                    <form method="post">
                        <button class="basket-button" type="submit" asp-page-handler="Buy" asp-route-itemId="@m.Id">
                            Add to Basket
                        </button>
                    </form>
                }
            </a>
        </div>
    }
</div>


@* <table class="table"> *@
@*     <thead> *@
@*         <tr> *@
@*             <th> *@
@*                 @Html.DisplayNameFor(model => model.MenuItem[0].Name) *@
@*             </th> *@
@*             <th> *@
@*                 @Html.DisplayNameFor(model => model.MenuItem[0].Desc) *@
@*             </th> *@
@*             <th> *@
@*                 @Html.DisplayNameFor(model => model.MenuItem[0].Available) *@
@*             </th> *@
@*             <th> *@
@*                 @Html.DisplayNameFor(model => model.MenuItem[0].Vegetarian) *@
@*             </th> *@
@*             <th> *@
@*                 @Html.DisplayNameFor(model => model.MenuItem[0].Price) *@
@*             </th> *@
@*             <th></th> *@
@*         </tr> *@
@*     </thead> *@
@*     <tbody> *@
@* @foreach (var item in Model.MenuItem) { *@
@*         <tr> *@
@*             <td> *@
@*                 @Html.DisplayFor(modelItem => item.Name) *@
@*             </td> *@
@*             <td> *@
@*                 @Html.DisplayFor(modelItem => item.Desc) *@
@*             </td> *@
@*             <td> *@
@*                 @Html.DisplayFor(modelItem => item.Available) *@
@*             </td> *@
@*             <td> *@
@*                 @Html.DisplayFor(modelItem => item.Vegetarian) *@
@*             </td> *@
@*             <td> *@
@*                 @Html.DisplayFor(modelItem => item.Price) *@
@*             </td> *@
@*             <td> *@
@*                 <a asp-page="./Edit" asp-route-id="@item.Id">Edit</a> | *@
@*                 <a asp-page="./Details" asp-route-id="@item.Id">Details</a> | *@
@*                 <a asp-page="./Delete" asp-route-id="@item.Id">Delete</a> *@
@*             </td> *@
@*         </tr> *@
@* } *@
@*     </tbody> *@
@* </table> *@
