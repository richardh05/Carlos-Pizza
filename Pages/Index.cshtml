@page
@using Carlos_Pizza.Models
@model IndexModel
@{
    ViewData["Title"] = "Home";
}

<div class="text-center">
    <h1 class="display-4">Welcome</h1>
    <p>Whether you're here for a classic or something new, we've got the perfect slice waiting for you. Please take a look.</p>
</div>

@* <div class="text-center"> *@
@*     <h2>Menu Table</h2> *@
@*     <table> *@
@*         <thead> *@
@*         <tr> *@
@*             <th>Name</th> *@
@*             <th>Description</th> *@
@*             <th>Price</th> *@
@*         </tr> *@
@*         </thead> *@
@*         <tbody> *@
@*         @foreach (var m in Model.MenuItems) *@
@*         { *@
@*             <tr> *@
@*                 <td>@m.Name</td> *@
@*                 <td>@m.Desc</td> *@
@*                 <td>@m.Price</td> *@

@*             </tr> *@
@*         } *@
@*         </tbody> *@
@*     </table> *@
@* </div> *@

@* <h2>Please take a look</h2> *@
<hr />

@* Flex-container to display items in a grid as clickable "tiles" *@
<div class="flex-container">
    @foreach (var m in Model.MenuItems.Where(item => item.Available == true))
    {
        <div>
            <a asp-page="Menu/Details" asp-route-id="@m.Id">
                
                @if (m.Image != null && m.Image.Length > 0)
                {
                    string base64String = Convert.ToBase64String(m.Image);
                    string imageSrc = $"data:image/webp;base64,{base64String}";
                    <img src="@imageSrc" alt="@Html.DisplayFor(modelItem => m.Name) image" />
                }
                <h3>@Html.DisplayFor(modelItem => m.Name)</h3>
                <p>@Html.DisplayFor(modelItem => m.Price)</p>
                @if (User.Identity is { IsAuthenticated: true })
                {
                    <form method="post">
                        <button class="basket-button" type="submit" asp-page-handler="Buy" asp-route-itemId="@m.Id">
                            Add to Basket
                        </button>
                    </form>
                }
            </a>
        </div>
    }
</div>